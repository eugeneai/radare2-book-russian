# Программа rahash2

Инструмент rahash2 можно использовать для вычисления контрольных сумм файлов, блоков данных дисковых устройств и строк. Реализовано множество различных хэш-алгоритмов. Также можно выполнять некоторые операции кодирования / декодирования, такие как шифрование base64 и xor (гаммирование).

Вот пример использования:

```
$ rahash2 -a md5 -s "hello world"
```

Обратите внимание, что rahash2 также позволяет считывать из stdin в потоке, поэтому не нужно выделять 4 ГБ оперативной памяти для вычисления хэша файла размером 4 ГБ.

## Блочное хеширование

При проведении сравнения больших объемов файлов полезно вычислять частичные контрольные суммы. При этом файл разделяется на небольшие части, которые легче идентифицировать по содержимому. Аналогично содержимое раздела диска разбивается на блоки, затем хешируются, и по значениям хэшей далее можно проводить сравнение. Если обнаружено два блока с один и тем же хэшем, то весьма вероятно содержание этих блоков будет одно и то же. Очень часто таким образом идентифицируются блоки с нулевыми значениями. Блочное хэширование удобно для определения того, какие блоки изменились. Также инструмент удобно при анализе дампов оперативной памяти с виртуальной машины. 

Построение блочного хэша делается при помощи команды, аналогичной

```
$ rahash2 -B 1M -b -a sha256 /bin/ls
```

## Хеширование при помощи rabin2

Инструмент rabin2 анализирует двоичные заголовки файлов, но он также может  использовать плагины rhash для вычисления контрольной суммы разделов в двоичном файле.

```
$ rabin2 -K md5 -S /bin/ls
```

## Получение хэшей в сеансе radare2

Вычисление контрольной суммы текущего блока при запуске radare2 - команда `ph`. Название алгоритма передается в качестве параметра. Пример сеанса:

```
$ radare2 /bin/ls
[0x08049790]> bf entry0
[0x08049790]> ph md5
d2994c75adaa58392f953a448de5fba7
```

Можно использовать все алгоритмы хеширования, поддерживаемые `rahash2`:

```
[0x00000000]> ph?
md5
sha1
sha256
sha384
sha512
md4
xor
xorpair
parity
entropy
hamdist
pcprint
mod255
xxhash
adler32
luhn
crc8smbus
crc15can
crc16
crc16hdlc
crc16usb
crc16citt
crc24
crc32
crc32c
crc32ecma267
crc32bzip2
crc32d
crc32mpeg2
crc32posix
crc32q
crc32jamcrc
crc32xfer
crc64
crc64ecma
crc64we
crc64xz
crc64iso
```

Команда `ph` принимает необязательный числовой аргумент для указания длины блока байтов, подлежащего хэшированию, параметр изменит размер блока по умолчанию. Например:

```
[0x08049A80]> ph md5 32
9b9012b00ef7a94b5824105b7aaad83b
[0x08049A80]> ph md5 64
a71b087d8166c99869c9781e2edcf183
[0x08049A80]> ph md5 1024
a933cc94cd705f09a41ecc80c0041def
```
