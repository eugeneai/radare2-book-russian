# Дизассемблирование

Дизассемблирование в радаре — это всего лишь способ представления массива байтов. Он обрабатывается как специальный режим печати внутри команды `p`.

В прежние времена, когда ядро радара было меньше, дизассемблер управлялся внешним файлом rsc. То есть радар сначала сбрасывал текущий блок в файл, а потом просто вызывал `objdump`, сконфигурированный на дизассемблирование для Intel, ARM и другие поддерживаемые архитектуры.

Это было работающее и дружественное к Unix решение, но оно было неэффективным, так как повторяло одни и те же дорогостоящие действия снова и снова, так же не было кеша. В результате прокрутка была ужасно медленной.

Поэтому возникла необходимость создать универсальную библиотеку дизассемблера для поддержки нескольких плагинов для разных архитектур. Перечислим текущие используемые плагины с помощью

```
$ rasm2 -L
```

или в radare2:

```
> e asm.arch=??
```

За много лет до появления capstone r2 использовал дизассемблеры udis86 и olly, разные от gnu (binutils).

В настоящее время поддержка дизассемблера является одной из основных особенностей радара. Теперь у него есть много параметров — порядок следования байтов, включая вариант целевой архитектуры и варианты дизассемблера и др.

Чтобы получить дизассемблированный код, используйте команду `pd`. Он принимает числовой аргумент, указывающий сколько оп-кодов текущего блока вы хотите видеть. Большинство команд в radare считают текущий размер блока ограничением по умолчанию для ввода данных. Если вы хотите дизассемблировать больше байтов, установите новый размер блока с помощью команды `b`.

```
[0x00000000]> b 100    ; установить размер блока равным 100
[0x00000000]> pd       ; дизассемблировать сто байт
[0x00000000]> pd 3     ; дизассемблировать три оп-кода
[0x00000000]> pD 30    ; дизассемблировать 30 байт
```

Команда `pD` работает как `pd`, но принимает в качестве аргумента количество байтов вместо количества оп-кодов.

Псевдосинтаксис может быть несколько проще для понимания человеком, чем нотации ассемблера по умолчанию. Но иногда становится раздражающим чтение большого объема кода. Попробуйте использовать разные варианты:

```
[0x00405e1c]> e asm.pseudo = true
[0x00405e1c]> pd 3
		  ; JMP XREF from 0x00405dfa (fcn.00404531)
		  0x00405e1c    488b9424a80. rdx = [rsp+0x2a8]
		  0x00405e24    64483314252. rdx ^= [fs:0x28]
		  0x00405e2d    4889d8       rax = rbx

[0x00405e1c]> e asm.syntax = intel
[0x00405e1c]> pd 3
		  ; JMP XREF from 0x00405dfa (fcn.00404531)
		  0x00405e1c    488b9424a80. mov rdx, [rsp+0x2a8]
		  0x00405e24    64483314252. xor rdx, [fs:0x28]
		  0x00405e2d    4889d8       mov rax, rbx

[0x00405e1c]> e asm.syntax=att
[0x00405e1c]> pd 3
		  ; JMP XREF from 0x00405dfa (fcn.00404531)
		  0x00405e1c    488b9424a80. mov 0x2a8(%rsp), %rdx
		  0x00405e24    64483314252. xor %fs:0x28, %rdx
		  0x00405e2d    4889d8       mov %rbx, %rax
```
