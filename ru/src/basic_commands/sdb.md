# База данных строк

SDB расшифровывается как String DataBase. SDB - это простая база данных "ключ-значение", работающая только со строками и созданная pancake. Она используется во многих частях r2, база данных реализуется на диске и в памяти, является небольшой и быстрой для управления, используется как хеш-таблица на стероидах.

SDB — это простая база данных строковых ключей/значений, основанная на дисковом хранилище djb cdb и поддерживающая JSON и интроспекцию массивов.

Также есть sdbtypes: библиотека vala, реализующая несколько структур данных поверх SDB или memcache.

SDB поддерживает:

- пространства имен (несколько путей sdb)
- атомарная синхронизация базы данных
- привязки для vala, luvit, newlisp и nodejs
- Интерфейс командной строки для баз данных sdb
- клиент и сервер memcache с бэкэндом sdb
- поддержка массивов (синтаксический сахар)
- парсер/интеграция json


## Пример использования
Создание базы данных!

```
$ sdb d hello=world
$ sdb d hello
world
```

Использование массивов:
```
$ sdb - '[]list=1,2' '[0]list' '[0]list=foo' '[]list' '[+1]list=bar'
1
foo
2
foo
bar
2
```

Потестируем json:
```
$ sdb d g='{"foo":1,"bar":{"cow":3}}'
$ sdb d g?bar.cow
3
$ sdb - user='{"id":123}' user?id=99 user?id
99
```

Используя командную строку без дисковой базы данных:
```
$ sdb - foo=bar foo a=3 +a -a
bar
4
3

$ sdb -
foo=bar
foo
bar
a=3
+a
4
-a
3
```
Удаление базы данных
```
$ rm -f d

```

## Зачем она?
Теперь можно базу внутри сеансов radare2!

Давайте возьмем простой двоичный файл и проверим, что уже _SDB_-изировано.
```
$ cat test.c
int main(){
	puts("Hello world\n");
}
$ gcc test.c -o test
```

```
$ r2 -A ./test
[0x08048320]> k **
bin
anal
syscall
debug
```

```
[0x08048320]> k bin/**
fd.6
[0x08048320]> k bin/fd.6/*
archs=0:0:x86:32
```
Файл, соответствующий шестому дескриптору файла, является двоичным файлом x86_32.

```
[0x08048320]> k anal/meta/*
meta.s.0x80484d0=12,SGVsbG8gd29ybGQ=
[...]
[0x08048320]> ?b64- SGVsbG8gd29ybGQ=
Hello world
```
Строки хранятся в кодировке base64.

---

## Еще примеры


Пространства имен
```
k **
```
Подпространства имен
```
k anal/**
```
Ключи
```
k *
k anal/*
```
Задание ключа
```
k foo=bar
```
Получение значения ключа
```
k foo
```

Список всех системных вызовов
```
k syscall/*~^0x
```
Список всех комментариев
```
k anal/meta/*~.C.
```
Показать комментарий при заданном смещении:
```
k %anal/meta/[1]meta.C.0x100005000
```
