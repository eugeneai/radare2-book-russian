## Сохранение данных

Radare может манипулировать загруженным двоичным файлом. Можно изменять размер файла, перемещать и копировать/вставлять байты, вставлять новые байты (перемещая данные в конец блока или файла) или просто перезаписывать байты. Новые данные могут быть предоставлены в виде строки специального вида, инструкций ассемблера, или они могут быть считаны из другого файла.

Изменения размера файла — команды `r`. Она принимает числовой аргумент. Положительное значение задает новый размер файла. Отрицательное значение приведет к усечению файла до текущей позиции поиска за вычетом N байтов.

```
r 1024      ; установить размер файла равным 1024 байт
r -10 @ 33  ; вырезать десять байт по смещению 33
```
Сохранение (запись в файл) байтов — команда `w`. Она поддерживает несколько форматов входных данных, таких как результаты ассемблирования, дружественные к порядку байтов DWORD, файлы, шестнадцатеричные файлы, широкие строки:

```
[0x00404888]> w?
Usage: w[x] [str] [<file] [<<EOF] [@addr]
| w[1248][+-][n]       увеличит/уменьшить на 1 байт, слово..
| w foobar             запись строки 'foobar'
| w0 [len]             запись 'len' байт значениями 0x00
| w6[de] base64/hex    запись base64-декодированной или -кодированной строки
| wa[?] push ebp       запись оп-кодов, разделеных символом ';' (окружите команду '"'-ками)
| waf f.asm            ассоциировать файл и результат записать
| waF f.asm            ассоциировать файл и результат записать, затем показать ('wx') оп-коды в шестнадцатеричном виде полученного кода
| wao[?] op            изменить оп-код (изменить условия переходов (jump), вставить nop и др.)
| wA[?] r 0            изменить/заменить оп-код по текущему смещению (смотрите wA?)
| wb 010203            заполнить текущий блок шестнадцатеричными данными циклично
| wB[-]0xVALUE         установить или сбросить биты заданным значением
| wc                   перечислить все изменения, относящиеся к записи
| wc[?][jir+-*?]       показать кэш команд undo/commit/reset/list (плагин io.cache)
| wd [off] [n]         сдублировать N байт (memcpy), расположенных в текущем смещении, также смотрите y?
| we[?] [nNsxX] [arg]  выполнять операции "запись" в режиме вставки (extend write)
| wf[fs] -|file        записать содержимое файла по текущему смещению
| wh r2                команды операционной системы whereis/which
| wm f0ff              установить двоичную маску в виде шестнадцатеричного кода для использования в последющих командах записи
| wo[?] hex            запись в блок при помощи операций. Инструкции - 'wo?' fmi
| wp[?] -|file         применить заплатку radare из файла. Инструкции - wp? fmi
| wr 10                запись десяти случайных байтов
| ws pstring           запись одного байта длины и затем строки
| wt[f][?] file [sz]   запись в файл (с текущего смещения, размером blocksize или sz байт)
| wts host:port [sz]   отправить данные на удаленную рабочую станцию host:port по tcp://
| ww foobar            запись wide-строки 'f\x00o\x00o\x00b\x00a\x00r\x00'
| wx[?][fs] 9090       запись двух intel-овских оп-кодов (с wxfile или wxseek)
| wv[?] eip+34         запись 32-64-товых значений с учетом cfg.bigendian
| wz string            запись строки, заканчивающейся нулем (аналогично w + \x00)
```

Примеры:

```
 [0x00000000]> wx 123456 @ 0x8048300
 [0x00000000]> wv 0x8048123 @ 0x8049100
 [0x00000000]> wa jmp 0x8048320
```

### Сохранение поверх существующих данных

Команда `wo` (write over) имеет множество подкоманд, каждая комбинирует существующие данные с новыми данными. Команда применяется к текущему блоку. Поддерживаемые операторы включают XOR, ADD, SUB, ...

```
[0x4A13B8C0]> wo?
|Usage: wo[asmdxoArl24] [hexpairs] @ addr[:bsize]
|Примеры:
|  wox 0x90   ; выполнить операцию xor 0x90 с текущим блоком
|  wox 90     ; выполнить операцию xor 0x90 с текущим блоком
|  wox 0x0203 ; выполнить операцию xor 0203 с текущим блоком
|  woa 02 03  ; добавить [0203][0203][...] к текущему блоку
|  woe 02 03  ; создать последовательность от 2 до 255 с шагом 3
|Поддерживаемые операции:
|  wow  ==  запись циклического значения (псевдоним для 'wb')
|  woa  +=  сложение
|  wos  -=  вычитание
|  wom  *=  умножение
|  wod  /=  деление
|  wox  ^=  xor (исключающее или)
|  woo  |=  or (или)
|  woA  &=  and (и)
|  woR  сгенерировать случайные байты (псевдоним для 'wr $b')
|  wor  >>= сдвиг вправо
|  wol  <<= сдвиг влево
|  wo2  2=  2-байтовый обмен
|  wo4  4=  4-байтовый обмен
```

Возможна реализация алгоритмов шифрования с использованием команд ядра radare и `wo`. Пример сеанса, выполняющего xor(90) + add(01, 02):

```
[0x7fcd6a891630]> px
- offset -       0 1  2 3  4 5  6 7  8 9  A B  C D  E F
0x7fcd6a891630  4889 e7e8 6839 0000 4989 c48b 05ef 1622
0x7fcd6a891640  005a 488d 24c4 29c2 5248 89d6 4989 e548
0x7fcd6a891650  83e4 f048 8b3d 061a 2200 498d 4cd5 1049
0x7fcd6a891660  8d55 0831 ede8 06e2 0000 488d 15cf e600
[0x7fcd6a891630]> wox 90
[0x7fcd6a891630]> px
- offset -       0 1  2 3  4 5  6 7  8 9  A B  C D  E F
0x7fcd6a891630  d819 7778 d919 541b 90ca d81d c2d8 1946
0x7fcd6a891640  1374 60d8 b290 d91d 1dc5 98a1 9090 d81d
0x7fcd6a891650  90dc 197c 9f8f 1490 d81d 95d9 9f8f 1490
0x7fcd6a891660  13d7 9491 9f8f 1490 13ff 9491 9f8f 1490
[0x7fcd6a891630]> woa 01 02
[0x7fcd6a891630]> px
- offset -       0 1  2 3  4 5  6 7  8 9  A B  C D  E F
0x7fcd6a891630  d91b 787a 91cc d91f 1476 61da 1ec7 99a3
0x7fcd6a891640  91de 1a7e d91f 96db 14d9 9593 1401 9593
0x7fcd6a891650  c4da 1a6d e89a d959 9192 9159 1cb1 d959
0x7fcd6a891660  9192 79cb 81da 1652 81da 1456 a252 7c77
```
