## Отображение файлов

Подсистема ввода-вывода Radare позволяет сопоставлять содержимое файлов в пространство ввода-вывода, используемое для хранения загруженного двоичного файла. Программа radare2 способна открывать файлы и отображать их части в любые места памяти, указывая такие атрибуты, как разрешения и имя. Это идеальный подход к воспроизведению среды, такой как core dump, сеанс отладки, а также загрузки и отображения в память всех библиотек, от которых зависит двоичный файл.

Команда `o` позволяет пользователю открыть файл, он отображается на смещение 0, если у него нет стандартного двоичного заголовка, карты памяти создаются в виртуальных адресах. Иногда надо перебазировать двоичный файл, или, загрузить и отобразить файл по другому адресу. При запуске r2 базовый адрес можно изменить флагом `-B`. Есть разница при открытии файлов с неизвестными заголовками, такими как booloader-ы, их нужно отображать при помощи флага `-m`, или указав его в качестве аргумента команде `o`. Посмотрим инструкцию для команды:

```
[0x00000000]> o?
|Usage: o [com- ] [file] ([offset])
| o                         перечень открытых файлов
| o-1                       закрыть файловый дескриптор 1
| o-!*                      закрыть все открытые файлы
| o--                       закрыть все файлы, анализы, двоичные файлы, флаги, тоже, что и !r2 --
| o [file]                  открыть файл [file] в режиме "только для чтения"
| o+ [file]                 открыть файл в режиме "чтение-запись"
| o [file] 0x4000 rwx       отобразить файл по адресу 0x4000
| oa[-] [A] [B] [filename]  указать архитектуру и размер регистров для заданного файла
| oq                        перечислить все открытые файлы
| o*                        перечислить открытые файлы в виде команд r2
| o. [len]                  открыть malloc://[len], копируя байты из текущего смещения
| o=                        перечислить открытые файлы (ascii-art bars)
| ob[?] [lbdos] [...]       перечислить открытые файлы "backed by" fd
| oc [file]                 открыть файл core-дампа, аналогично перезапуску r2
| of [file]                 открыть файл и отобразить его по адресу 0 в режиме "только для чтения"
| oi[-|idx]                 синоним для o, но используя индекс вместо fd
| oj[?]                     перечислить открытые файлы в формате JSON
| oL                        перечислить все зарегистрированные плагины ввода-вывода
| om[?]                     создать, перечислить, удалить карты ввода-вывода
| on [file] 0x4000          отобразить raw-файл по смащению 0x4000 (при этом r_bin не используется)
| oo[?]                     переоткрыть текущий файл (kill+fork в отладчике)
| oo+                       переоткрыть текущий файл в режиме "только для чтения"
| ood[r] [args]             переоткрыть в режиме отладки (с аргументами)
| oo[bnm] [...]             смотри инструкцию при помощи oo?
| op [fd]                   приоритизировать заданый fd (смотри также ob)
| ox fd fdx                 поменять местами fd-descs и fdx и сохранить отображение
```

Покажем простой пример:

```sh
$ rabin2 -l /bin/ls
[Linked libraries]
libselinux.so.1
librt.so.1
libacl.so.1
libc.so.6

4 libraries
```

Сопоставление файла:

```
[0x00001190]> o /bin/zsh 0x499999
```

Список отображенных файлов:

```
[0x00000000]> o
- 6 /bin/ls @ 0x0 ; r
- 10 /lib/ld-linux.so.2 @ 0x100000000 ; r
- 14 /bin/zsh @ 0x499999 ; r
```

Показать шестнадцатеричные значения из /bin/zsh:

```
[0x00000000]> px @ 0x499999
```

Отмена отображения файлов с помощью команды `o-`. Укажите дескриптор файла в качестве аргумента:

```
[0x00000000]> o-14
```

Также можно просмотреть таблицу ascii со списком открытых файлов:

```
[0x00000000]> ob=
```
