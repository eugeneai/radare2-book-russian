# Макросы

Помимо просто последовательности команд и циклов, radare2 позволяет записывать простые макросы, используя конструкцию:
```
[0x00404800]> (qwe; pd 4; ao)
```

Эта форма определяет макрос под названием 'qwe', запускающий последовательно сначала 'pd 4', затем 'ao'.
Вызов макроса с использованием синтаксиса `.(макрос)`:

```
[0x00404800]> (qwe; pd 4; ao)
[0x00404800]> .(qwe)
0x00404800  mov eax, 0x61e627      ; "tab"
0x00404805  push rbp
0x00404806  sub rax, section_end.LOAD1
0x0040480c  mov rbp, rsp

address: 0x404800
opcode: mov eax, 0x61e627
prefix: 0
bytes: b827e66100
ptr: 0x0061e627
refptr: 0
size: 5
type: mov
esil: 6415911,rax,=
stack: null
family: cpu
[0x00404800]>
```

Чтобы просмотреть доступные макросы, вызовите `(*`:
```
[0x00404800]> (*
(qwe ; pd 4; ao)
```

А если хотите удалить какой-то макрос, просто добавьте '-' перед названием:
```
[0x00404800]> (-qwe)
Macro 'qwe' removed.
[0x00404800]>
```

Можно создать макрос, принимающий аргументы, - удобный механизм при создании простых сценариев. Чтобы создать макрос, принимающий аргументы, просто добавьте их в определение макроса.

```
[0x00404800]
[0x004047d0]> (foo x y; pd $0; s +$1)
[0x004047d0]> .(foo 5 6)
;-- entry0:
0x004047d0      xor ebp, ebp
0x004047d2      mov r9, rdx
0x004047d5      pop rsi
0x004047d6	mov rdx, rsp
0x004047d9	and rsp, 0xfffffffffffffff0
[0x004047d6]>
```
Как видите, аргументы называются по индексу, начиная с 0: $0, $1, ...

# Псевдонимы

radare2 также включает псевдонимы, помогающие сэкономить время, быстро выполняя наиболее часто используемые команды. Они находятся в `$?`

Общее использование функции - `$alias=cmd`

```
[0x00404800]> $disas=pdf
```

Приведенная выше команда создаст псевдоним `disas` для `pdf`. Следующая команда выводит разборку основной функции.

```
[0x00404800]> $disas @ main
```

Помимо команд, вы также можете назвать текст, который будет напечатан при вызове.

```
[0x00404800]> $my_alias=$test input
[0x00404800]> $my_alias
test input
```

Чтобы отменить определение псевдонима используйте `$alias=`:
```
[0x00404800]> $pmore='b 300;px'
[0x00404800]> $
$pmore
[0x00404800]> $pmore=
[0x00404800]> $

```

Один `$` в приведенном выше списке будет перечислять все определенные псевдонимы. Также можно проверить команду псевдонима:
```
[0x00404800]> $pmore?
b 200; px
```

Можно ли создать псевдоним, уже содержащий псевдоним? Ответ - да.
```
[0x00404800]> $pStart='s 0x0;$pmore'
[0x00404800]> $pStart
- offset -   0 1  2 3  4 5  6 7  8 9  A B  C D  E F  0123456789ABCDEF
0x00000000  7f45 4c46 0201 0100 0000 0000 0000 0000  .ELF............
0x00000010  0300 3e00 0100 0000 1014 0000 0000 0000  ..>.............
0x00000020  4000 0000 0000 0000 5031 0000 0000 0000  @.......P1......
0x00000030  0000 0000 4000 3800 0d00 4000 1e00 1d00  ....@.8...@.....
0x00000040  0600 0000 0400 0000 4000 0000 0000 0000  ........@.......
0x00000050  4000 0000 0000 0000 4000 0000 0000 0000  @.......@.......
0x00000060  d802 0000 0000 0000 d802 0000 0000 0000  ................
0x00000070  0800 0000 0000 0000 0300 0000 0400 0000  ................
0x00000080  1803 0000 0000 0000 1803 0000 0000 0000  ................
0x00000090  1803 0000 0000 0000 1c00 0000 0000 0000  ................
0x000000a0  1c00 0000 0000 0000 0100 0000 0000 0000  ................
0x000000b0  0100 0000 0400 0000 0000 0000 0000 0000  ................
0x000000c0  0000 0000 0000 0000                      ........
[0x00000000]>
```
