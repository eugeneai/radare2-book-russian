## Обычный поиск

Поиск обычной текстовой строки в файле будет выглядеть примерно так:

```
$ r2 -q -c "/ lib" /bin/ls
Searching 3 bytes from 0x00400000 to 0x0041ae08: 6c 69 62
hits: 9
0x00400239 hit0_0 "lib64/ld-linux-x86-64.so.2"
0x00400f19 hit0_1 "libselinux.so.1"
0x00400fae hit0_2 "librt.so.1"
0x00400fc7 hit0_3 "libacl.so.1"
0x00401004 hit0_4 "libc.so.6"
0x004013ce hit0_5 "libc_start_main"
0x00416542 hit0_6 "libs/"
0x00417160 hit0_7 "lib/xstrtol.c"
0x00417578 hit0_8 "lib"
```

Как видно из вывода выше, radare2 генерирует флаг "hit" (*вхождение*) для каждой найденной записи. Затем можно использовать команду `ps`, чтобы увидеть строки, хранящиеся в смещениях, отмеченных флагами, имена будут выведены в форме `hit0_<номер_вхождения>`:

```
[0x00404888]> / ls
...
[0x00404888]> ps @ hit0_0
lseek
```

Можно искать строки с wide-символами (например, буквы юникода) с помощью команды `/w`:

```
[0x00000000]> /w Hello
0 results found.
```

Для выполнения поиска строк без учета регистра используйте параметр `/i`:

```
[0x0040488f]> /i Stallman
Searching 8 bytes from 0x00400238 to 0x0040488f: 53 74 61 6c 6c 6d 61 6e
[# ]hits: 004138 < 0x0040488f  hits = 0
```

В строке поиска можно указывать шестнадцатеричные escape-последовательности, предварив их `\x`:

```
[0x00000000]> / \x7FELF
```

Если вместо этого ищете строку шестнадцатеричных значений, вероятно лучше использовать команду `/x`:

```
[0x00000000]> /x 7F454C46
```

Если надо замаскировать некоторый кусок во время поиска, можно использовать символ **.** (точка):

```
[0x00407354]> /x 80..80
0x0040d4b6 hit3_0 800080
0x0040d4c8 hit3_1 808080
0x004058a6 hit3_2 80fb80
```

Если вам не известны некоторые значения битов вашего шестнадцатеричного паттерна,  можно использовать битовую маску в вашем шаблоне. Каждый бит,  равный единице в маске, указывает на поиск значения бита в шаблоне. Бит, равный нулю в маске, указывает, что значение совпадающего значения может быть равно 0 или 1:

```
[0x00407354]> /x 808080:ff80ff
0x0040d4c8 hit4_0 808080
0x0040d7b0 hit4_1 808080
0x004058a6 hit4_2 80fb80    
```

Можно заметить, что команда `/x 808080:ff00ff` эквивалентна команде `/x 80..80`.

После завершения поиска результаты сохраняются в пространстве флага `searches`.

```
[0x00000000]> fs
0    0 . strings
1    0 . symbols
2    6 . searches

[0x00000000]> f
0x00000135 512 hit0_0
0x00000b71 512 hit0_1
0x00000bad 512 hit0_2
0x00000bdd 512 hit0_3
0x00000bfb 512 hit0_4
0x00000f2a 512 hit0_5
```

Чтобы удалить флаги "hit", используйте команду `f-hit*`.

Часто во время длительных сеансов поиска нужно запускать последний поиск более одного раза. Вы можете использовать команду `//` для повторения последнего поиска.

```
[0x00000f2a]> //     ; повторить последний поиск
```
